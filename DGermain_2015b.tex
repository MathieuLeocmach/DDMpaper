%   This file is part of the AIP files in the AIP distribution for REVTeX 4.
%   Version 4.1 of REVTeX, October 2009
%
%   Copyright (c) 2009 American Institute of Physics.
%
%   See the AIP README file for restrictions and more information.
%
% TeX'ing this file requires that you have AMS-LaTeX 2.0 installed 
% as well as the rest of the prerequisites for REVTeX 4.1
%
% It also requires running BibTeX. The commands are as follows:
%
%  1)  latex  aipsamp
%  2)  bibtex aipsamp
%  3)  latex  aipsamp
%  4)  latex  aipsamp
%
% Use this file as a source of example code for your aip document.
% Use the file aiptemplate.tex as a template for your document.
\documentclass[prb,reprint,amsmath,amssymb]{revtex4-1} 
%\documentclass[%
% aip,
% jmp,%
% amsmath,amssymb,
%%preprint,%
%reprint,%
%%author-year,%
%%author-numerical,%
%]{revtex4-1}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}  % needed for \tfrac, \bmatrix, etc.
\usepackage{amsfonts} % needed for bold Greek, Fraktur, and blackboard bold
%\usepackage{graphicx} % needed for figures

\usepackage[pdftex]{graphicx}% Include figure files
%\usepackage{tabularx}
%\usepackage{bm}% bold math
\usepackage{epstopdf}
\usepackage{siunitx}
\usepackage{xcolor}
\usepackage{algpseudocode}
\usepackage[pdftex=true,colorlinks=true,linkcolor=blue,citecolor=blue]{hyperref}
\usepackage[all]{hypcap} %% Sans ce package, lorsqu'on clique sur un lien menant à une image, ça ne mène pas au bon endroit
%\usepackage{booktabs}
\epstopdfsetup{outdir=./epstopds_converted/}
%\usepackage[mathlines]{lineno}% Enable numbering of text and display math
%\linenumbers\relax % Commence numbering lines
\newcommand*\circled[1]{\raisebox{0.5pt}{\textcircled{\raisebox{-.9pt} {#1}}}}
%\newcommand{\hh}{\\ \vspace{0.1cm} \\}
%\graphicspath{{C:/thomas/research/david/Article/epstopds_converted}}
%\graphicspath{{epstopds_converted}}
\newcommand{\tg}[1]{{\color{magenta}#1}} % remarques de Seb

\begin{document}

\preprint{AIP/123-QED}

\title[Differential Dynamic Microscopy to characterize Brownian motion and bacteria motility]{Differential Dynamic Microscopy\\ to characterize Brownian motion and bacteria motility}% Force line breaks with \\

\author{David Germain}
\author{Mathieu Leocmach}
\author{Thomas Gibaud}
\email[Correspondence and requests for materials should be addressed to ]{thomas.gibaud@ens-lyon.fr}
\affiliation{Universit\'e de Lyon, Laboratoire de Physique, \'Ecole Normale Sup\'erieure de Lyon, CNRS UMR 5672, 46 All\'ee d'Italie, 69364 Lyon cedex 07, France}

\date{\today}% It is always \today, today, but any date may be explicitly specified

\begin{abstract}
We have developed a lab work module where we teach undergraduate students how to quantify the dynamics of a suspension of microscopic particles, measuring and analyzing the motion of those particles at the individual level or as a group. 
Differential Dynamic Microscopy (DDM) is a relatively recent technique that precisely does that and constitutes an alternative method to more classical techniques such as dynamics light scattering (DLS) or video particle tracking (VPT). DDM consists in imaging a particle dispersion with a standard light microscope and a camera. The image analysis requires the students to code and relies on digital Fourier transform to obtain the intermediate scattering function, an autocorrelation function that characterizes the dynamics of the dispersion. We first illustrate DDM on the textbook case of colloids where we measure the diffusion coefficient. Then we show that DDM is a pertinent tool to characterize biologic systems such as motile bacteria \tg{i.e.bacteria that can self propel}, where we not only determine the diffusion coefficient but also the velocity and the fraction of motile bacteria. Finally, so that  our paper can be used as a tutorial to the DDM technique, we have joined to this article movies of the colloidal and bacterial suspensions and the DDM algorithm in both Matlab and Python to analyze the movies.
\end{abstract}

\pacs{42.30Va -- 87.17.Jj -- 82.70.Dd -- 87.80}% PACS, the Physics and Astronomy Classification Scheme.
\keywords{Dynamics, Bacteria, Colloid, Microscopy, Intermediate Scattering Function, Image Analysis, Tutorial}%Use showkeys class option if keyword. display desired
\maketitle

\section{\label{sec:level1}Introduction}

Quantifying the dynamics of a suspension of microscopic particles consists in measuring and analyzing the motion of those particles at the individual level or as a group. Like hockey for Canadians or cricket for Indians and Pakistanis, quantifying the dynamics of a suspension of microscopic particles is the national sport of a large community of researchers in physics and biology. For example, a century ago, Perrin has characterized the motion of small particles in a liquid, an experiment that evidenced the Brownian motion and firmly proved the existence of atoms \cite{22_perrin2014atomes}. More recently, the motion of tracer particles has been used extensively in soft matter\cite{pt1990witten, pt1964reiner} to extract the mechanical properties such as viscosity or elasticity of fluids, gels\cite{Mason1997, Chen2010}, pastes, cell cytoplasm\cite{Fabry2001,Lau2003} and foods at scales unreachable by macroscopic techniques. In the past decade, the study of the collective motion of fish schools, bird flocks and bacteria swarms has lead to the emergence of a new field, active matter \cite{Bricard2013}.

Video Particle Tracking (VPT) and Dynamic Light Scattering (DLS) are two of the most well-known techniques that allows to characterize the dynamics of a suspension of microscopic particles and that have been widely described in a teaching context. VPT consists in tracking the position of an individual particle as a function of time to digitalize its trajectory. It provides precise information of small portions of a sample \citep{Crocker1996,ajp2013catipovic,Maurer2014}. DLS consists in shining a laser through the particle suspension and monitoring the fluctuations of scattered intensity as a function of time\cite{ajp1969clark}. It yields average information about the dynamics of a sample \citep{18_sartor2003dynamic, ajp1999goldburg,ajp1969clark}.

Here, we present a tutorial for an alternative method called Differential Dynamic Microscopy (DDM) recently proposed by Cerbino and Trappe \cite{2_DDM}. DDM is intuitive as it deals with real-space video of the moving objects like VPT, however it uses digital Fourier transform to obtain the same kind of information as DLS.  Contrary to tracking algorithm, DDM algorithm is straightforward to implement at the programming level of most undergraduate students. We believe lab work on DDM is a great opportunity to become familiar with a microscope and with reciprocal units, the range of accessible wavenumbers and other nitty-gritty details necessary to tame the power of the Fourier transform\cite{ajp1976higgins, ajp2001whiford}. We have joined to this article movies of suspensions with different types of particles and the DDM codes in Matlab and Python so that the reader may reproduce the image analysis proper to DDM, see EPAPS.

In this article, we show how to apply DDM to two sets of different micrometer particles, colloids at first, then motile bacteria, \tg{i.e.bacteria that can self propel}. In section \ref{materials}, we present the materials and method we use to prepare the samples as well as the acquisition parameters. \tg{Section \ref{sec:ddm} presents the DDM principle and algorithm}. In section \ref{sec:BrownSection}, we \tg{use DDM to characterize the Brownian motion of colloidal particles which has been widely studied in a teaching context~\cite{ajp1997lemons, ajp2006newburgh, ajp2006bergstein} and we determine the diffusion coefficient of the particles}. In section \ref{sec:BactSection}, we apply DDM to \textit{salmonella} bacteria and show that it is possible to characterize entangled dynamics where the bacteria both diffuse and ``swim". \tg{In particular we determine the proportion of motile bacteria, their diffusion coefficient as well as their velocity}. This last example highlight the impact of physical techniques on biology. Finally in section~\ref{didac} we focus of the didactic aspect of the lab work.

\section{Materials and methods}
\label{materials}
\subsection{Colloidal particles}

As colloidal particles, we use polystyrene spheres (Density of polystyrene, $\rho_\text{c}$ = $\SI{1.04}{\gram\per\centi\meter\cubed}$) with a catalog radius of $R=\SI{0.50}{\micro\meter}$  (FluoSpheres\circledR{} from Thermo Fisher Scientific). The commercial dispersion is diluted 50 times in \tg{deionized} water \tg{(at $T=\SI{20}{\degree C}$ the viscosity of water is $\eta =\SI{1.002}{\milli\pascal\second}$, and its density is $\rho_\text{s}=\SI{1.00}{\gram\per\centi\meter\cubed}$)} to a final concentration of $\SI{1e8}{particles\per\milli\liter}$ so that we have a dilute dispersion: \tg{the distance between two individual particles} is large compared to $R$, typically $20 R$. This concentration remains sufficiently high to observe enough particles in the camera field of view and to \tg{accumulate satisfactory statistics}. Polystyrene refractive index is $\approx 1.6$, larger than the one of water $\approx 1.3$, so the particles are visible in bright field microscopy.

To observe the Brownian motion of particles in a Newtonian fluid, several conditions are required \citep{16_CollSusp}. The particle has to be colloidal, meaning that its size has to be far larger than the size of the solvent molecules, it is the case for the suspension we used \tg{(molecular diameter of water \citep{17_marcus1998properties}  $\SI{0.34}{\nano\meter}$)}. Furthermore, colloidal particles have to be in the dilute regime to avoid interaction between them. This is checked once the sample is made. As our particles do not have long distance interaction, we estimate that the sample is dilute when the mean distance between particles is higher than at least 10 times the diameter of a particle. Finally, one has to make sure that the thermal agitation is the physical process that dominates the dynamics of the colloidal particles. We ensure that the solvent is not flowing by using an immobile, sealed and thin optical cell with negligible temperature gradient. The sedimentation motion can be characterized by the P\'eclet number \citep{12_patankar1980numerical, ajp2009saka}
\begin{equation}
\text{Pe}_\text{g} = \frac{E_\text{g}}{E_\text{th}},
\end{equation}
where $E_\text{g} = \frac{4 \pi R^3}{3}  (\rho_\text{c} - \rho_\text{s}) g  2R$ is the variation of potential energy for a difference of altitude equal to the diameter $2R$ of the particle, $E_\text{th} = k_\text{B} T$ is the thermal energy, $\rho_\text{c}$ and $\rho_\text{s}$ the respective densities of the particle and the surrounding solution, $g$ the acceleration of gravity, $k_\text{B}$ the Boltzmann constant and $T$ the temperature. Here we have $\text{Pe}_\text{g} \approx 0.1$, indicating that the sedimentation can be neglected over Brownian motion. Equivalently in the time domain, our particle sediments and diffuses on a distance equal to its own diameter on a characteristic time $\tau_\text{s}=9\eta/(8(\rho_\text{c}-\rho_\text{s}) R)\approx$ 100 s for sedimentation much larger than the characteristic time $\tau_\text{d}=24\pi\eta R^3/k_BT\approx$2 s for diffusion. Absence of both flow and sedimentation will be verified \textit{a posteriori}. In presence of a flow the trajectory of the particle, that should be random, is biased in the direction of the flow.

\subsection{Bacteria}
In section \ref{sec:BactSection}, we study the motion of non-pathogenic bacteria \tg{\textit{Salmonella Typhimurium SJW1103}  (American Type Culture Collection, Manassas, VA, U.S.A.)} \citep{21_fabrega2013salmonella}. \tg{This bacteria has the shape of a rod with a length of $\SI{2}{\micro\meter}$ and a diameter of around $\SI{1}{\micro\meter}$ and is motile because it can self propel. The global motion of the bacteria can be split into two modes. In the ``tumble'' mode, the motors rotate clockwise and independently, causing the bacteria to move erratically. In the ``run'' mode, the motors are synchronised and rotate counter-clockwise leading the bacteria to move ballistic and straight forward. A mean tumble has an average time of $\SI{0.1}{\second}$ and a run has an average time of $\SI{1}{\second}$ \citep{5_berg2000motile}. Although a tumble reorients the bacteria in a random direction, it is able to migrate stochastically toward a more favorable environment by changing the frequency of the reorientation—depending on the gradient of the temperature or concentration of molecules of interest (i.e., sugars, amino acids, dipeptides). As we gently mixed the culture medium during growth, the nutriment medium can be considered homogeneous in our samples and the bacteria are moving isotropically.}

\textit{Salmonella Typhimurium SJW1103}  are stored in a freezer at $\SI{-80}{\degree C}$ in a mixture of water ($\simeq \SI{33}{\%} w$) and glycerol ($\simeq 66\% w$). First, using a sterile inoculation loop, we streak bacteria from the storage solution on a sterile agar/LB plates  ($\SI{500}{\milli\liter}$ of LB/agar was made of $\SI{5}{\gram}$ of NaCl, $\SI{5}{\gram}$ of Tryptone, $\SI{2.5}{\gram}$ of Yeast Extract, $\SI{7.5}{\gram}$ of Agar). Second, the agar plates are closed and placed in an incubator at $\SI{37}{\degree C}$. The agar plates are oriented such that the LB/agar gel is at the top, to prevent the condensation from disturbing the development of the bacteria. After $\simeq$ 12 hours, we observe the formation of monoclonal circular colonies. Third, Using an inoculation loop, we take a monoclonal colony of bacteria from LB/Agar plate and disperse it in a \textsc{Falcon} tube with $\simeq \SI{5}{\milli\liter}$ TN growth medium. The TN growth medium is sterile and composed of $\SI{4}{\gram\per\liter}$ of bacto-tryptone, $\SI{2.5}{\gram\per\liter}$ of NaCl and $0.4\% w$ of glycerol diluted in water. The \textsc{Falcon} tubes have an oxygen permeable cap which allows the bacteria to breath and limits evaporation. Those bacteria are pre-cultured for a night at $\SI{32}{\degree C}$ \tg{at a shaking speed of} 300 rpm in an Incu-Shaker 10L. Finally, we collected $\SI{50}{\micro\liter}$ of the solution of bacteria with a sterile pipette and we put it in a new \textsc{Falcon} tube filled with $\simeq \SI{5}{\milli\liter}$ of TN growth medium. The tube is then placed in the Incu-Shaker 10L at 300 rpm and $\SI{32}{\degree C}$ for 1h30. Around this time the optical density (OD) at $\SI{600}{\nano\meter}$ is around OD=0.5 and most bacteria are ``swimming". It is important to grow bacteria in a nutriment poor media and to collect them early on, at low concentrations, otherwise the bacteria tend not to develop a flagella. More details about bacteria preparation can be obtained in ref\cite{Schwarz2015, ajp2010hagen, XXX}.

\subsection{Microscope slide}
For the microscope observations, the aqueous suspension of colloids or bacteria are enclosed in a home made hermetic optical cell, Fig.\ref{Slide}.a and observed at room temperature, $T=\SI{20}{\degree C}$. The cell is composed of a  glass slide (\textsc{RS France}) and a cover slip (\textsc{Menszel-gl\"aser}) spaced by two stripes of paraffin film (\textsc{Bemis}) \tg{creating a slit between the glass slide and the cover slip of approximately $\SI{125}{\micro\meter}$}. The optical cell is briefly heated on a hot plate so that the paraffin welds to the slide and the cover slip. The suspension of colloids or bacteria is then introduced into the slit by capillarity, and the slit is immediately sealed at both extremity using ultraviolet-cured glue (Norland Optical).

%fig 1%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
\includegraphics[width=\linewidth]{Lamelle_Photos.pdf}
\caption{Experimental setup. (a) Schematics of the microscope cell used to study the motion of particles, namely, colloids and bacteria. (b) Typical bright field image of our colloidal suspension. (c) idem with bacteria.}
\label{Slide}
\end{figure}

\subsection{Microscope and acquisition parameters}

The colloidal and bacterial suspensions are observed with light field microscope\cite{Mignard2015} (\textsc{nikon Eclipse Ti}) in \tg{bright field} with an objective $10 \times$ of numerical aperture $N.A. = 0.3$, Fig.\ref{Slide}.b-c. The focus is made in the middle of the microscope slide in $z$-direction. It allows to be far from the boundaries where particles could be stuck on the slide and could not move in the 3 dimensions. Images are acquired with a camera (\textsc{Hamamatsu ORCA-Flash 2.8}).



The images are coded in $\SI{8}{bits}$  grey-scale: each pixel intensity is proportional to the incoming light intensity from the sample and varies linearly from  0 (black) to 255 (white). Using an exposure time of $\SI{1}{\milli\second}$, we adjusted the brightness of the microscope light in order to have a maximum number of pixel around a value of $\sim 120$ which minimize the amount of saturated pixels.

The choice of the acquisitions parameters is a compromise between the spatial and the temporal resolution. With the $10\times$ objective, a pixel corresponds to $dL=\SI{0.645}{\micro\meter}$, a bit smaller than the optical resolution of the microscope, $\lambda/(2N.A.)\approx\SI{0.8}{\micro\meter} $. Bacteria or colloids are about $\SI{1}{\micro\meter}$ and therefore correspond to a few pixels on the camera. We chose a $(\SI{512}{px})^2$ field of view which is large enough to capture the motion of 100 of particles and small enough to reach high acquisition frequencies, up to $\SI{400}{\hertz}$. At $\SI{400}{\hertz}$ it is impossible to directly send the data from the camera to the computer during the capture, so we have to temporarily save the acquisition on the buffer of the camera, and, once it is over, we send the data from the buffer of the camera to the computer. The camera buffer memory limits the number of images in one stack to 4000. To cover a wide range of time scales, we chose to acquire a first stack of 4000 images at $\SI{400}{\hertz}$ and a second similar stack at $\SI{4}{\hertz}$. With this procedure, we cover time scales between $\SI{2.5e-3}{\second}$ and $\SI{1000}{\second}$ and length scales between $dL=\SI{0.645}{\micro\meter}$ and $L=\SI{330}{\micro\meter}$. In Fourier space, the wave number increment, which also corresponds to the minimum wave number, is related to the image size, $dq=2\pi/L=\SI{0.019}{\micro\meter^{-1}}$. The maximum wave number is $q_{max}=2\pi/(2dL)=\SI{4.87}{\micro\meter^{-1}}$. Indeed according to the Nyquist–Shannon sampling theorem, the smallest wavelength measurable corresponds to a sinusoidal wave of period 2 pixels: 1 pixel for the positive part of sinusoidal wave and 1 pixel for the negative.

\section{Differential dynamic microscopy}
\label{sec:ddm}
\subsection{DDM principle}

Dynamic Light Scattering (DLS) and Differential Dynamic Microscopy (DDM) are two different ways to obtain the auto-correlation function \tg{$f$}\cite{ajp1995passmore} of a stationary system, that is to say a system whose statistical properties does not change when shifted in time. \tg{$f(q, \Delta t)$ is sensitive to the dynamics of the system and measures the similarity of the statistical properties of the suspensions after a lag time $\Delta t$ at a wavevector $\vec{q}$. For randomly moving particles such as the colloidal and bacterial suspensions, $f$ decays with $\Delta t$ from 1 when the system has not changed ($\Delta t=0$) to 0 when the system has changed completely $(\Delta t\rightarrow\infty)$. $f(q, \Delta t)$ depends on the length scale via  $q$. The characteristic decay time of $f$ is longer for large length scales, i.e. smaller $q$ because larger structures need longer time to decorrelate. The combined dependence of $f$ with $q$ and $\Delta t$ contains information about the physical origin of the decorrelation process. Based on dimension analysis, the characteristic decorrelation time $\tau$ necessary to diffuse a density is proportional to $(2\pi/q)^2$ and $f$ can be scaled on a master curve when plotted as a function of $q^2\tau$ (dimension of the inverse of the diffusion coefficient) whereas the characteristic decorrelation time $\tau$ necessary to advect a density is proportional to the distance $2\pi/q$ and $f$ can be scaled on a master curve when plotted as a function of $q\tau$ (dimension of the inverse of the velocity) rather than $\tau$. Using an appropriate model to describe the dispersion dynamics of the system, one can determine $f$ and then fit the experimental $f$. For Brownian colloids the measurements and the fit of $f$ permits to determine $D$ the diffusion coefficient of the colloidal particles and for the bacteria suspension it allows the determination of the ratio of motile bacteria, their diffusion coefficient as well as their velocity.}

In DLS, we measure the intensity $\hat{I}(\vec{q}, t)$ scattered by the sample at a given angle, i.e at a given wavector $\vec{q}$ in the Fourier space as function of time. The autocorrelation of the scattered intensity yields the so called Intermediate Scattering Function (ISF)~\cite{19_goodman2005introduction} $F(q, t, \Delta t) = \left\langle \hat{I}^*(\vec{q}, t) \hat{I}(\vec{q}, t+\Delta t) \right\rangle$ \tg{which is the product between the scattered intensity at time $t$,  $\hat{I}^*(\vec{q}, t)$, and time $t+\Delta t$, $\hat{I}(\vec{q}, t+\Delta t)$.} The brackets denote the average over the initial time $t$ and the orientation of the wavevector $\vec{q}$. The ISF is normalized into $f$ by
\begin{equation}
f(\vec{q}, \Delta t) = \frac{F(\vec{q}, \Delta t)}{F(\vec{q}, 0)}.
\end{equation}

\tg{In DDM, we acquire microscopy images in real space, $I(\vec{r}, t)$. In real space the autocorrelation function $f(\vec{r}, \Delta t)$ is defined by a convolution product between two images separated by $\Delta t$. The convolution product is a computationally intensive operation since it requires $N^2$ operations, $N$ being the number of pixels in the image. However in Fourier space the convolution product becomes an inexpensive simple product, thanks to the Wiener-Khintchine theorem and the fast Fourier transform algorithm requires a most $N\log N$ operations}. In DDM  we therefore numerically Fourier transform the image and $f(q, \Delta t)$ is obtained as follow.

%fig 2%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure*}
	\includegraphics[width=\linewidth]{Graph.pdf}\\
	\caption{\tg{DDM principle. a) Schematic of the DDM algorithm. b) Image differences of the colloidal suspension $\Delta I(\vec{r}, t,\Delta t=100 \text{ s})$. c) Square of the Fourier transform $|\widehat{\Delta I}|^2$ of the image in  (b). d) DDM matrix for the colloidal suspension radial averaged and projected on $q$ for different lag times $\Delta t$. e) DDM matrix for the colloidal suspension radial averaged and projected on $\Delta t$ for different $q$.}}
	\label{D}
\end{figure*}

 We consider the difference between two images separated by $\Delta t$,
\begin{equation}
\Delta I(\vec{r},t, \Delta t) = I(\vec{r}, t+\Delta t) - I(\vec{r}, t)
\label{eq:DI}
\end{equation}

and we compute numerically its spatial 2D Fourier transform $\widehat{\Delta I}$. Once ensemble averaged on $t$, the squared normed of this quantity, the DDM matrix $\mathcal{D}$, is directly related to the correlation function, thanks to the cross product term:
\begin{align*}
\mathcal{D}(\vec{q},\Delta t) \equiv& \left\langle \left|\widehat{\Delta I}\right|^2 \right\rangle\\
 =& \left\langle \left|\widehat{I}(\vec{q},t+\Delta t) - \widehat{I}(\vec{q},t)\right|^2 \right\rangle \\
=& \left\langle \left|\widehat{I}(\vec{q},t+ \Delta t)\right|^2 + \left|\widehat{I}(\vec{q},t)\right|^2\right. \\
&\left.- 2 \, \widehat{I}^*(\vec{q},t+\Delta t) \widehat{I}(\vec{q},t) \right\rangle\\
=& \underbrace{2F(\vec{q}, 0)}_{\equiv A(\vec{q})} \bigg[ 1-\underbrace{\frac{F(\vec{q}, \Delta t)}{F(\vec{q}, 0)}}_{f(\vec{q}, \Delta t)} \bigg] \addtocounter{equation}{1}\tag{\theequation} \label{eq:DDM}
\end{align*}


\tg{For a system with isotropic dynamics such as the colloidal or the bacteria dispersion,  $\mathcal{D}(\vec{q},\Delta t)$  is isotropic. We therefore radial average $\mathcal{D}(q,\Delta t)$ and drop the dependence on the orientation of the wavevector $\vec{q}$.}

The contribution of the \tg{dark, shot and read-out noise\cite{Mignard2015,Joubert2011}} of the camera is taken into account by adding a supplementary term $B(q)$. $B(q)$ is decorrelated  at all time and therefore independent of $\Delta t$.

\begin{equation}
\mathcal{D}(q,\Delta t) = A(q)\left[1-f(q, \Delta t)\right] + B(q)
\label{eq:D2f}
\end{equation}

\tg{The DDM matrix does not directly yield $f$. Ones need to correctly evaluate $A(q)$ and $B(q)$ to get $f$. Two different strategies can be adopted. In the first one, the parameters $A(q)$ and $B(q)$ are measured independently based on the properties of $\mathcal{D}$: at short times, $\mathcal{D}(q,\Delta t\rightarrow 0) = B(q)$, and long times, $\mathcal{D}(q,\Delta t\rightarrow \infty) = A(q)+B(q)$. This first method gives access directly to the autocorrelation function $f$ which can then be fitted. It is however necessary to measure small enough and  long enough lag time with respect to the decorrelation time otherwise $B$ is overestimated and $A+B$ is underestimated, respectively. The other strategy consists in fitting the DDM matrix with $A$ and $B$ as free parameters and a model for $f$. This last method is less demanding on the range of the lag time $\Delta t$ but it requires a model for $f$ and therefore prevents a scaling approach in the first place.}

\subsection{DDM algorithm}

\tg{The DDM algorithm yields the DDM matrix $\mathcal{D}(q,\Delta t)$ from a stack of microscope images. It consists on a double iteration on $t$ and $\delta t$. A few tricks are performed to gain calculation time. In the loop on $t$ (XXX range?), we first open the couple of images $I(\vec{q},t)$ and $I(\vec{q},t+\Delta t)$, calculate $\Delta I(\vec{r},t, \Delta t)$  Eq.~\eqref{eq:DI} and $\mathcal{D}(\vec{q},\Delta t)$ Eq.~\eqref{eq:DDM}. This last operation uses the Fast Fourier Transform (FFT) algorithm which is widespread and included in most high-level languages. The calculation time necessary to compute all the FFT at all the accessible $t$ can become very long (some hours). The  loop on $t$ permits to gather statistics on $\mathcal{D}$. We downsized the iteration range which extend to $t-\Delta t$ to a maximum of 300 by sampling the initial times $t$  evenly across the accessible time window. At the end of this loop we average  $\mathcal{D}$ and make the radial average. At this point we have calculated $\mathcal{D}$ but only for one $\Delta t$. We now iterate on $\Delta t$. Again to save calculation time, we logarithmically sampled $\Delta t$ with 10 points per decades which reduces the number of iteration from 3999 to XXX 35. With those optimizations, the calculation time falls to a few minutes.

We run the DDM procedure on both stacks of images at $\SI{400}{\hertz}$ and $\SI{4}{\hertz}$ independently. We then merged the two sets of data by scaling the data at $\SI{4}{\hertz}$ so that both values at $\SI{0.25}{\second}$ are equal. We average the values of $\mathcal{D}$ at $\SI{4}{\hertz}$ and $\SI{400}{\hertz}$ in the overlap interval, from $\SI{0.25}{\second}$ to $\SI{10}{\second}$. We thus obtain $\mathcal{D} (q, \Delta t)$ for $\Delta t$ from $\SI{2.5e-3}{\second}$ to $\SI{1000}{\second}$ a range of $\Delta t$ wide enough to correctly measure or fit $A$ and $B$.

The final step consist in analyzing $\mathcal{D}$ (Eq.~\eqref{eq:D2f}) to extract information on dynamics of the observed dispersion. In the following, for both colloidal and bacteria suspensions, we decided to display $f$ rather than $\mathcal{D}$ because it is easier to interpret and to compare to DLS experiments. Scaling will be displayed using direct measure of $A(q)$ and $B(q)$, whereas model-dependent parameters will be obtained by fitting. $\mathcal{D}$ is fitted in logarithmic scale in order not to attribute too much weight on points with high intensity and we dismiss timescales above \SI{200}{\second} where the statics is poor because $\mathcal{D}$ is averaged less than 4 times.}

\section{Brownian motion and DDM}
\label{sec:BrownSection}

\subsection{The Brownian motion of colloids}
The Brownian motion is the unceasing and random motion of small particles suspended in a fluid at rest. It is due to the shocks between the solvent molecules and the colloidal particles. The history of Brownian motion is particularly interesting~\cite{13_brown1828brief,9_einstein1906theory, 14_sutherland1905lxxv, 10_von1906kinetischen,ajp1997lemons,22_perrin2014atomes} and has often been reviewed~\cite{ajp1997lemons, ajp2006newburgh, ajp2006bergstein}. For spherical Brownian particles  diffusing in the  background solvent, it can be shown that the autocorrelation function is\cite{18_sartor2003dynamic, ajp1999goldburg,ajp1969clark,8_berne2000dynamic}:
\begin{equation}
f(q, \, \Delta t) = \exp(-\Delta t/\tau_\text{d})\text{ with }\tau_\text{d} = \frac{1}{Dq^2}.
\label{eq:fdiff}
\end{equation}
$\tau_\text{d}$ is the characteristic diffusion time of the exponential decay and $D$ the diffusion coefficient of the particles. $D$ is increasing with the temperature and decreasing with the radius $R$ of the particle and the viscosity $\eta$ of the fluid according to the \textsc{Stokes-Einstein} formula \cite{Nelson2014, 16_CollSusp, ajp1997lemons, ajp2007jia}:
\begin{equation}
D = \frac{k_\text{B} T}{6 \pi \eta R}
\end{equation}

\subsection{Results}
\label{resultcolloid}


From the short and long times values of $\mathcal{D}(q)$, we estimate $A(q)$ and $B(q)$ and isolate $f$, Fig.\ref{ISF}.a. According to (Eq.~\ref{eq:fdiff}), by plotting $f(q, \Delta t)$ as a function of $\Delta t q^2$, we remove the $q$-dependence on $f$ resulting into a collapse of the data on a master curve, Fig.\ref{ISF}.b. The scaling is compatible with a diffusive process.


Now we use the second strategy, using as free parameters $A$, $B$ and $\tau_d$ in Eq.~\eqref{eq:fdiff} for $f$, for each $q$ we fit $\mathcal{D}(q, \Delta t)$ (Eq. \eqref{eq:D2f}) as a function of $\Delta t$. The initial parameters for the fit are:
\begin{equation}
\left\{
\begin{array}{rcl}
A_0 &=& \mathcal{D} (q,\Delta t_\text{max}) - \mathcal{D} (q,\Delta t_\text{min}) \\
B_0 &=& \mathcal{D} (q,\Delta t_\text{min}) \\
\tau_\text{d} &=& \SI{1}{\second}
\end{array}
\right.
\end{equation}
where $\Delta t_\text{max}$ and $\Delta t_\text{min}$ are respectively the maximum and the minimum interval of time between two images.

%fig %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
	\includegraphics[width=\linewidth]{ISFColloides.pdf}\\
	\caption{\tg{Autocorellation function extracted from the DDM matrix $\mathcal{D}$} at various $q$ versus $\Delta t$ (a) and $\Delta tq^2$ (b). Lines are exponential fits to the data according to Eq.~\ref{eq:fdiff}.}
	\label{ISF}
\end{figure}

The fit results are displayed  as a function of $q$ in Fig.\ref{FitDiffColl}.We observe 3 regimes,  Fig.\ref{FitDiffColl}:
\begin{itemize}
\item[\textbf{(1)}] Insufficient statistics. The radial average is performed on very few pixels (4 pixels for $q = q_\text{min}$ which correspond to the central cross of the Fourier transforms).  Also, at small $q$ the characteristic time is comparable to the duration of the experiment, $\SI{1000}{\second}$.
\item[\textbf{(3)}] For  $q>\SI{3.5}{\per\micro\meter}$, $A(q)$ (signal) is too close to $B(q)$ (noise), to yield a consistent fit. This sets the spatial resolution of DDM to  $\frac{2\pi}{3.5} = \SI{1.8}{\micro\meter}$.
\item[\textbf{(2)}] Statistics are good and the signal-to-noise ratio is low enough.
\end{itemize}

We fit $\tau_\text{d}(q)$ in regime (2) according to (Eq.~\ref{eq:relax}), which corresponds in logarithmic scale to a straight line of slope -2 and of intercept $-\log(D)$, Fig.\ref{FitDiffColl}.a. The theoretical model is in a very good agreement with our measurements and we obtain a diffusion coefficient of $D_\text{fit} = \SI{0.39}{\micro\meter\squared\per\second}$. Using the Stokes-Einstein formula with our experimental conditions, we obtain $D_\text{E} = \SI{0.41}{\micro\meter\squared\per\second}$ which implies an error of only $\sim 5 \%$. 

\tg{Using DDM, we always subtract images with one another and therefore we remove all static artifacts encounter in the optical path such as optical aberation or dirt on the slide. We can see three main sources of uncertainties that affect the precision of the DDM results. First it is necessary to measure fast enough enough so that $f$ remains almost completely correlated and long enough so that $f$ becomes completely  decorrelated. If this is not properly done on the short times $B$ is underestimated and consequently so is $\tau_\text{d}$. If this is not properly done on the long times then  $A+B$ is underestimated and consequently is $\tau_\text{d}$ overestimated. Experimentaly this is easily checkable. One needs to observe for each $q$ two plateaus of the DDM matrix $\mathcal{D}$ at short and long lag times $\Delta t$. Then, the choice of the region (2) where we fit the characteristic time also need to be properly estimated. Finally, the results are model dependent. Ones need in fact to take the proper model for $f$. For example, the model in Eq.~\eqref{eq:fdiff}  considers that the particles are monodisperse. This is not exactly the case: the manufacturer stipulate a 10\% polydispersity. This could be refine by integrating a size polydispersity. DDM is all the more precise that the experimentalists have some good knowledge about the system they study and have also first validated their procedure on a simple system like the one presented in this section}.

Finally, We also have access to informations about the parameters $A(q)$ and $B(q)$ , Fig.\ref{FitDiffColl}.b. According to our data, the noise level $B(q)$ seems constant for every $q$: the camera is adding a white noise to each images. With bright field, due to the depth of field of the objective in the $z$-direction, we are imaging a volume projected on $xy$ plane. The effect of the depth of field mostly affect the large length scales (small $q$) due to the disappearance of particles from the $z$-field and lead to underestimate the dynamics characteristic times\cite {4_Martinez20121637}. Taking into account the 3D nature of the experiment,  F. Giavazzi et al.\citep{3_DDM3D} have shown that it is possible to model $A(q)$.

%fig %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
	\includegraphics[width=\linewidth]{DiffusionColloids.pdf}\\
	\caption{Characteristic Brownian diffusion time and the parameters $A(q)$, $B(q)$ \tg{as extracted from the fit of the measurements of the DDM matrix $\mathcal{D}$. (a) $\tau_\text{d}$ (\textcolor{blue}{$\circ$}) and its fit (\textcolor{red}{\textbf{---}}) versus $q$. (b) Fit parameters $A$ ($\ast$), $B$ (\textcolor{blue}{+}). The red dashed line is a fit of $A(q)$ to the model in Ref\citep{3_DDM3D}.} }
	\label{FitDiffColl}
\end{figure}

In this section, we have verified and dissected the DDM procedure. We have shown that we obtain via the intermediate scattering function quantitative information on the 3D dynamics of a hundreds of colloidal particles simultaneously on length scales ranging from $\sim \SI{2}{\micro\meter}$ to $\sim \SI{200}{\micro\meter}$ and on time scales ranging from the millisecond to the minutes. This exact experiment can also be exploited in a different manner thanks to the Stokes Einstein formula. Provided  that we know the temperature $T$ and the hydrodynamics radius of the particles $R$, we can measure the viscosity of the solvant $\eta$. \tg{In our experiment, we find $\eta$= XXX mPas}. Compared to a classical rheology experiment, DDM is actually better suited to measure small viscosity ($\sim$ mPas) of a solvent that we have on limited quantities ($\sim$ 50 $\mu L$). Finally, provided that this time we know $T$ and $\eta$, we can measure $R$ for particles size ranging from tens of nanometers to a few microns \cite{2_DDM}.  \tg{In our experiment, we find $R= XXX\SI{1111}{\micro\meter}$}. Given the robustness and high throughput of DDM, DDM is appropriate for screening purposes.

\section{Bacteria and DDM}
\label{sec:BactSection}

\subsection{Motile Bacteria}

\tg{\textit{The Salmonella Typhimurium SJW1103} dispersion has a more complex dynamics than colloidal dispersion. We used the same acquisition parameters as with the colloids and applied the same algorithm as the one presented above. We extracted $f$ from the DDM matrix using the first strategy where $A$ and $B$ are measure experimentally.} Contrary to the colloidal case, $f(q, \Delta t)$ shows a two step decay which corresponds to two decorrelation mechanisms, Fig.\ref{ISFBacteria}.a. We first identify the physical origin of those mechanism by trying a scaling approach. The first decorrelation mechanism, for $\Delta t < \SI{0.3}{\second}$, is due to a ballistic motion of bacteria. It is confirmed as the first decay of $f$  for different $q$  collapses on a master curve as we scale $f$ with the abscissa  $\Delta t q$ (dimension of an inverse velocity), see Fig.\ref{ISFBacteria}.b. The second decorrelation mechanism is due to a diffusion process and confirmed by the collapse of the second decay of $f$ for different $q$ when plotted as a function of $\Delta t q^2$ (dimension of an inverse diffusion coefficient), see Fig.\ref{ISFBacteria}.c.

Based on the scalings properties of the $f$, we turn to a model that takes into account \tg{the Brownian motion of bacteria due to $k_BT$, the mean velocity and the velocity distribution during the run, the fact that some of our bacteria are motile and some are not. Considering these new conditions, it can be shown that an adequate $f$ is \citep{1_BactMobil}}:

\begin{align}
f(q, \Delta t) &= \exp\left(-\frac{\Delta t}{\tau_\text{d}}\right)\left[(1-\alpha) + \alpha \mathcal{P}(q, \Delta t)\right],\label{eq:fbact}\\
\mathcal{P}(q, \Delta t) &= \int_{0}^{\infty} P(v)\, \text{sinc}(\Delta t/\tau_\text{r}) \mathrm{d}v,
\end{align}
with $\tau_\text{d} = 1/(Dq^2)$ the characteristic Brownian diffusion time and $\tau_\text{r}=1/(q\overline{v})$ the characteristic run time.

$\alpha$ is the fraction of motile bacteria. $\text{sinc}(\Delta t/\tau_\text{r})$ is the $f$ of an isotropic population of swimmers at velocity $v$. The distribution of velocity $P(v)$ and the integral $\mathcal{P}(q, \Delta t)$ over $v$ take into account that all bacteria do not move at the same velocity. Following Wilson et al.\cite{1_BactMobil}, we chose a Schulz distribution for $P(v)$ which respects the apparent dynamic of bacteria, i.e. peaked around the average velocity $\overline{v}$ and going to 0 when $v \rightarrow \infty$:
\begin{equation}
P(v) = \frac{v^Z}{Z!} \left(\frac{Z+1}{\overline{v}}\right)^{Z+1} \exp\left[-\frac{v(Z+1)}{\overline{v}}\right],
\end{equation}
with $Z$ is a parameter related to the standard deviation $\sigma$ of the distribution $P(v)$:
\begin{equation}
Z = \left( \frac{\overline{v}}{\sigma} \right)^2 -1.
\label{eq:sig}
\end{equation}
It is then possible to formally calculate the integral $\mathcal{P}$:
\begin{equation}
\mathcal{P}(q, \Delta t) = \frac{\sin\left(Z\tan^{-1}\theta\right)}{Z\theta\left(1+\theta^2\right)^{Z/2}}\text{, with }\theta = \frac{\Delta t}{\tau_r(Z+1)}. 
\end{equation}




%fig %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
	\includegraphics[width=\linewidth]{ISF_Fonction_TetTq2etTq_Bact.pdf}\\
	\caption{Autocorellation function $f$ extracted from $\mathcal{D}$ at various $q$ versus $\Delta t$ (a), $\Delta tq$ (b) and $\Delta tq^2$ (c). Lines are fit to the data according to \tg{Eq.~\eqref{eq:fbact}.}}
	\label{ISFBacteria}
\end{figure}

\subsection{Results}
\tg {Using the fitting strategy of $\mathcal{D}(q, \Delta t)$} with Eq.~\eqref{eq:fbact} as model for $f$, requires 6 parameters. Even though the 2 decays of $f$ are well separated in time, we have initialized the fit with values very close to the results so that the fit converges:
\begin{equation}
\left\{
\begin{array}{rcl}
A_0 &=& \mathcal{D} (q,\Delta t_\text{max}) - \mathcal{D} (q,\Delta t_\text{min}) \\
B_0 &=& \mathcal{D} (q,\Delta t_\text{min}) \\
\tau_\text{d0} &=& 1/(0.1 q^{2})\\
\tau_\text{r0} &=& 1/(10 q)\\
\alpha_0 &=& 0.5\\
Z_0 &=& 1
\end{array}
\right.
\end{equation}

The interesting fit-output parameters are displayed in Fig. \ref{FitParametersBacteria} function of $q$. We limit the $q$ range to the regime (2) set by the colloid experiment where the statistics and the signal to noise are optimal. \tg{Fig. \ref{FitParametersBacteria}a display the run time and the diffusion time as the function of $q$ and are fitted in logarithmic scale by straight lines of respective slopes -1 (ballistic) and -2 (diffusion). The intercept of $\tau_\text{d}$ yields a diffusion coefficient of  $D = \SI{0.28}{\micro\meter\squared\per\second}$. The \textsc{Stokes-Einstein} relation considering spherical bacteria of diameter $\SI{1.5}{\micro\meter}$, a viscosity $\eta = \SI{1}{\milli\pascal\second}$ and a temperature $T=\SI{293}{\kelvin}$, yields $D_\text{SE} = \SI{0.28}{\micro\meter\squared\per\second}$, a very good agreement even though we are not considering the real shape of bacteria. The intercept of $\tau_\text{r}$  yields the mean velocity of the bacteria $\overline{v} = \SI{21.2}{\micro\meter\per\second}$ in the ''run" state. \textit{The Salmonella Typhimurium SJW1103}  are quite fast compared to E. Coli ($\overline{v} \approx \SI{10}{\micro\meter\squared\per\second}$)\cite{4_Martinez20121637}. In Fig.~\ref{FitParametersBacteria}b, we show the fraction of motile bacteria as a function of $q$. Our bacteria suspension displays a high fraction of motile bacteria, $\alpha\approx$ 0.8 compared to E. Coli ($\alpha\approx 0.6$)\cite{4_Martinez20121637}. This is why we chose this XXXspices rather than  E. Coli. In Fig. \ref{FitParametersBacteria}c-d, we show the Shultz distribution properties $Z$ and $\sigma$. The standard deviation of the  Shultz distribution is $\sigma=\SI{11.3}{\micro\meter\per\second}$. We note that $\alpha$, $Z$ and $\sigma$ are expected to be constant as the statistical properties of the bacteria dispersion and should not change over the duration of the experiment nor with $q$. This is roughly what we observe.}

In the model and our experiment we are not characterizing tumble. On the experimental side, this would require to measure over a much longer time. On the theoretical side, Martens et al. \cite{6_martens2012probability} have proposed a model for the autocorrelation function that takes into account the tumble.

%fig %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
	\includegraphics[width=\linewidth]{VitesseDiffusionParams.pdf}\\
	\caption{Fit parameters for the motile bacteria as a function of $q$  \tg{as extracted from the fit of the measurements of the DDM matrix $\mathcal{D}$.} (a) characteristic time for the diffusion, $\tau_d$ (\textcolor{red}{$\circ$}), and balistic motion, $\tau_r$ (\textcolor{blue}{$\circ$}). (b) Fraction of motile bacteria $\alpha$. (c) $Z$. Inset: Shulz velocity distribution, $P$ for $<Z>$=2.4. (d) Standard deviation of the Shulz distribution $\sigma$ obtained from Eq. \eqref{eq:sig}.}
	\label{FitParametersBacteria}
\end{figure}

\section{\label{didac}Didactic considerations}
\tg{We had the chance to test this lab work on an unusually long format: 48h spread on 6 days. However, provided that the DDM code is already written~\cite{code_github}, the colloid part of this paper can be accomplished in a regular lab class of 8h. An other option is a physics-inspired computer project. In this case, the students start from the movies in EPAPS and have to write the code to analyse them.}

For the record, here is the schedule on 6 days with the corresponding physical notions that we introduced. On day 1, they learned to prepare colloidal sample, to use the microscope and camera, section \ref{materials}. We visualize their first movies with the user-friendly and free software  ImageJ. Based on those movies, we ask them various questions: describe the motion of particles? What triggers this motion? We make the link with the concept of diffusion. What about gravity? Can you build a dimensionless number that characterize the competition between diffusion and gravity? Then we discuss different techniques to access dynamics of a colloidal dispersion, namely, particle tracking, DLS and DDM.

On day 2, they start coding. Spencer and Deutsch provide insightful didactic discussions on computational physics with python\cite{ajp2014deutsh} and matlab\cite{ajp2005spencer}. We discuss with the students how to translate the principle of DDM into an algorithm, section \ref{sec:ddm}. Then they start to code. To keep the code structured and readable for us we give them the signature of each function to code with predefined input and output. They are not supposed to be proficient in coding so we regularly check on them and debug with them. In this first version, the algorithm is not yet optimized: all the images are open, the $\Delta t$ is sampled linearly and we only test the code on 100s of images. In this way the students can feel that unoptimized  calculations are heavy and unpractical for longer movies. All along this process, we discuss the nitty-gritty of the Fourier transform, units conversion and the Nyquist–Shannon sampling theorem.

On day 3, they optimize the code so that it can deal with a stack of 4000 images within $\sim$10 minutes. At this point we teach them how to produce scientific figures that well describe the different steps of the DDM algorithm. We finish by discussing the DDM resolution and limitation, section \ref{resultcolloid}.

On day 4, they go back to experiments and optimize the acquisition parameters for the DDM analysis. We come back to the concept of correlation function, introduce the proper fitting form the autocorrelation function and discuss the least square method. At the end of the day the colloid project should be finished and the diffusion coefficient compared with the theoretical value given by the \textsc{Stockes-Einstein} formula.

On days 5 and 6, they deal with the bacteria, learning the culture method and the much more complex fitting function. 





\section{\label{cl}Conclusion}

Differential Dynamic Microscopy (DDM) is a microscopy technique that probes the dynamics of a system of particles using a microscope, a camera and numerical computations. We exposed this technique in the well-known case of simple Brownian motion before applying it to the more complex case of a motile bacteria. We have shown how to extract physically relevant information from DDM based on scaling and how to obtain quantitative values such as the diffusion coefficient or the velocity.

DDM is based  on microscopy and can therefore benefit from  more advanced techniques than bright field imaging. For example, it is possible to use fluorescence microscopy to tell apart colloidal probes in a crowed medium\cite{Hendricks2015}, confocal microscopy\cite{Lu2012}, or polarized light microscopy\citep{20_reufer2012differential}. Apart from colloidal Brownian motion, DDM has also been used to characterize ellipsoidal particles\citep{20_reufer2012differential} and kinetics of phase separation\cite{Gao2015} and aggregation\cite{Ferri2011} \tg{and other kind of bacteria, such as E. Coli or C. Reinhardtii\cite{4_Martinez20121637}}. Even macroscopic systems, like human crowds shot from above, could be studied by DDM. In that sense, DDM opens much more possibilities than dynamic light scattering and can be used in various contexts both in the lab and in the classroom.

\section*{EPAPS}
\label{sec:epaps}
EPAPS are accessible as zip file at: \url{http://perso.ens-lyon.fr/thomas.gibaud/ddm} and  contains 4 movies and a note describing each movies:
\begin{itemize}
 \item Movie 1: bright field stack composed of 4000 images of colloidal particle dispersed in water. $f_{acq}=400$ Hz. $\SI{1}{px} = \SI{0.645}{\micro\meter}$. Image size = $(\SI{512}{px})^2$.
 \item Movie 2: bright field stack composed of 4000 images of colloidal particles dispersed in water. $f_{acq}=4$ Hz. $\SI{1}{px} = \SI{0.645}{\micro\meter}$. Image size = $(\SI{512}{px})^2$.
 \item Movie 3: bright field stack composed of 4000 images of $salmonella$ bacteria dispersed in water. $f_{acq}=400$ Hz. $\SI{1}{px} = \SI{0.645}{\micro\meter}$. Image size = $(\SI{512}{px})^2$.
 \item Movie 4: bright field stack composed of 4000 images of $salmonella$ bacteria dispersed in water. $f_{acq}=4$ Hz. $\SI{1}{px} = \SI{0.645}{\micro\meter}$. Image size = $(\SI{512}{px})^2$.
\end{itemize}

We have attributed a DOI \href{http://dx.doi.org/10.5281/zenodo.20945}{10.5281/zenodo.20945}\cite{code_github} to the codes which are accessible at GitHub.


\begin{acknowledgments}
The authors would like to thank the students who endured the initial versions of this lab work: Alicia Damm, Florine Dubourg, D.G. himself, Paul Haddad, Gabriel Rigon and Sylvie Sue. 
This work was supported by the ENS Lyon, the Agence Nationale de la Recherche fran\c{c}aise (ANR-11-PDOC-027) and ML thanks the Region Rh\^one Alpes and
the Programme d'Avenir Lyon - Saint Etienne (PALSE NoGELPo) for postoctoral grant.
\end{acknowledgments}

\bibliographystyle{apsrev4-1}
\bibliography{./DGermain_2015bib}


\end{document}
